<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- ═══════════════════════════════════════════════════════════════
             GIFT LIST RECORD RULES
             ═══════════════════════════════════════════════════════════════ -->

        <!-- User Rule: Can see lists where they are advisor or manager sees all -->
        <record id="rule_gift_list_user" model="ir.rule">
            <field name="name">Gift List: User sees own store lists</field>
            <field name="model_id" ref="model_baby_list"/>
            <field name="domain_force">[
                '|',
                ('store_id', '=', False),
                ('advisor_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Advisor Rule: Can see/edit lists they created or in their store -->
        <record id="rule_gift_list_advisor" model="ir.rule">
            <field name="name">Gift List: Advisor manages own lists</field>
            <field name="model_id" ref="model_baby_list"/>
            <field name="domain_force">[
                '|',
                ('advisor_id', '=', user.id),
                ('store_id', '=', False)
            ]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_advisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Manager Rule: Global access to all lists -->
        <record id="rule_gift_list_manager" model="ir.rule">
            <field name="name">Gift List: Manager sees all</field>
            <field name="model_id" ref="model_baby_list"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- ═══════════════════════════════════════════════════════════════
             GIFT LIST ITEM RECORD RULES
             ═══════════════════════════════════════════════════════════════ -->

        <!-- Items inherit access from parent list -->
        <record id="rule_gift_list_item_user" model="ir.rule">
            <field name="name">Gift List Item: User sees items of visible lists</field>
            <field name="model_id" ref="model_baby_list_item"/>
            <field name="domain_force">[
                '|',
                ('list_id.store_id', '=', False),
                ('list_id.advisor_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_gift_list_item_advisor" model="ir.rule">
            <field name="name">Gift List Item: Advisor manages items of own lists</field>
            <field name="model_id" ref="model_baby_list_item"/>
            <field name="domain_force">[
                '|',
                ('list_id.advisor_id', '=', user.id),
                ('list_id.store_id', '=', False)
            ]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_advisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_gift_list_item_manager" model="ir.rule">
            <field name="name">Gift List Item: Manager sees all</field>
            <field name="model_id" ref="model_baby_list_item"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- ═══════════════════════════════════════════════════════════════
             GIFT LIST FAMILY RECORD RULES
             ═══════════════════════════════════════════════════════════════ -->

        <!-- Family members inherit access from parent list -->
        <record id="rule_gift_list_family_user" model="ir.rule">
            <field name="name">Gift List Family: User sees family of visible lists</field>
            <field name="model_id" ref="model_baby_list_family"/>
            <field name="domain_force">[
                '|',
                ('list_id.store_id', '=', False),
                ('list_id.advisor_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_gift_list_family_advisor" model="ir.rule">
            <field name="name">Gift List Family: Advisor manages family of own lists</field>
            <field name="model_id" ref="model_baby_list_family"/>
            <field name="domain_force">[
                '|',
                ('list_id.advisor_id', '=', user.id),
                ('list_id.store_id', '=', False)
            ]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_advisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_gift_list_family_manager" model="ir.rule">
            <field name="name">Gift List Family: Manager sees all</field>
            <field name="model_id" ref="model_baby_list_family"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_gift_list_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

    </data>
</odoo>
